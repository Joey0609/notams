<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="statics/styles.css">
    <!-- Leaflet -->
    <link rel="stylesheet" href="statics/leaflet/leaflet.css" />
    <script src="statics/leaflet/leaflet.js"></script>
    <script src="https://cdn.counter.dev/script.js" data-id="0208cb8b-4c1b-4996-b09e-dc4c551828a5" data-utcoffset="8"></script>
    <title>NOTAM历史航警匹配</title>
</head>

<body>
    <div class="smoke">
        <div id="allmap" class="div1"></div>

        <!-- 右侧统一按钮组 -->
        <div id="sidebarToggle" onclick="toggleSidebar()">匹配列表</div>

        <!-- 统一侧边栏 - 仅显示匹配历史航警 -->
        <div id="notamSidebar" class="notam-sidebar">
            <div id="notamListPage" class="sidebar-page">
                <div id="notamSidebarHeader" class="sidebar-header">
                    <div class="sidebar-title">历史航警匹配 <span id="notamCount">0</span> 条</div>
                    <div>
                        <button id="btnBack" onclick="window.history.back()">返回</button>
                        <button class="sidebar-close" onclick="toggleSidebar()">×</button>
                    </div>
                </div>
                <div id="notamList"></div>
            </div>
        </div>

        <div class="export-btn" id="exportButton">导出</div>
        <div class="help-btn" id="helpButton">帮助</div>

        <div class="export-area" id="exportArea">
            <div class="export-content">
                <div class="export-section">
                    <h4>导出图片设置</h4>
        
                    <!-- 导出范围 -->
                    <div style="margin-bottom: 12px;">
                        <label style="display: block; margin-bottom: 4px; font-weight: bold;">导出范围</label>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <select id="exportRange" class="archive-input" style="flex: 1;">
                                <option value="current"  selected>当前地图视图</option>
                                <option value="full">包含所有落区</option>
                                <option value="custom">自定义区域</option>
                            </select>
                            <button id="selectAreaBtn" class="select-area-btn" style="display: none;">选择区域</button>
                        </div>
                    </div>
        
                    <div style="display: flex; gap: 12px; margin-bottom: 12px;">
                        <!-- 导出格式 -->
                        <div style="flex: 1;">
                            <label style="display: block; margin-bottom: 4px; font-weight: bold;">格式</label>
                            <select id="exportFormat" class="archive-input" style="width: 100%;">
                                <option value="png">PNG</option>
                                <option value="jpeg">JPEG</option>
                            </select>
                        </div>
                    
                        <!-- 图片质量 -->
                        <div style="flex: 1;">
                            <label style="display: block; margin-bottom: 4px; font-weight: bold;">质量</label>
                            <select id="exportQuality" class="archive-input" style="width: 100%;">
                                <option value="1" selected>x1（普通）</option>
                                <option value="2">x2（标准）</option>
                                <option value="3">x3（高清）</option>
                                <option value="4">x4（超清）</option>
                            </select>
                        </div>
                    </div>
                    <button id="btnExportImage" class="archive-search-btn" style="width: 100%;">导出图片</button>
                </div>
            </div>
        </div>

        <div class="expandable-area" id="expandableArea">
            <div class="expandable-content">
                <div class="help-section">
                    <h4>关于NOTAMS</h4><a href="https://tieba.baidu.com/p/5492230455" target="_blank">获取NOTAMS的方式</a>
                </div>
                <div class="help-section">
                    <h4>获取NOTAMS的网站</h4><a href="https://pilotweb.nas.faa.gov" target="_blank">pilotweb.nas.faa.gov</a>
                </div>
                <div class="help-section">
                    <h4>关于本项目/获取帮助</h4>
                    <a href="https://github.com/Joey0609/notams" target="_blank">GitHub仓库</a>
                    <a href="https://www.bilibili.com/opus/1005673245294198789" target="_blank">B站专栏</a>
                    <a href="https://tieba.baidu.com/p/9298301903" target="_blank">百度贴吧</a>
                </div>
                <div class="help-section">
                    <h4>调试工具</h4><a href="#" onclick="toggleLogPanel(); return false;">查看终端日志</a>
                </div>
            </div>
        </div>

        <div class="log-panel" id="logPanel">
            <div class="log-header">
                <span>查看终端日志</span>
                <div>
                    <button class="log-clear-btn" onclick="clearLogs()">清空</button>
                    <button class="log-close-btn" onclick="toggleLogPanel()">×</button>
                </div>
            </div>
            <div class="log-content" id="logContent">
                <div class="log-empty">暂无日志</div>
            </div>
        </div>

        <div id="loadingModal" class="loading-modal">
            <div class="loading-content">
                <button class="loading-close-btn" onclick="closeLoadingModal()">×</button>
                <div class="spinner"></div>
                <p>正在加载匹配的历史航警...<br><br>你可以关闭该窗口<br>这不会影响操作</p>
            </div>
        </div>
    </div>

    <!-- 外部脚本加载 -->
    <script src="scripts/notamsDrawer.js"></script>
    <script src="scripts/buttons.js"></script>
    <script src="scripts/scripts.js"></script>
    <script src="statics/leaflet/leaflet-image.js"></script>
    <script src="scripts/customAreaSelect.js"></script>
    <script src="scripts/exportImage.js"></script>
    <script src="scripts/archiveSidebar.js"></script>
    <script src="scripts/archiveMatchScript.js"></script>
</body>

</html>